<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Snakemake for Lattice Quantum Field Theory: Tidying up</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png"><link rel="manifest" href="favicons/incubator/site.webmanifest"><link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Lesson Description" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/cleanup.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Snakemake for Lattice Quantum Field Theory
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Snakemake for Lattice Quantum Field Theory
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Snakemake for Lattice Quantum Field Theory
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 73%" class="percentage">
    73%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 73%" aria-valuenow="73" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/cleanup.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Running commands with Snakemake</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="python.html">2. Running Python code with Snakemake</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="placeholders.html">3. Placeholders and wildcards</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="chaining.html">4. Chaining rules</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="parameters.html">5. Metadata and parameters</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="multiple.html">6. Multiple inputs and outputs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="dag.html">7. How Snakemake plans jobs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="optimisation.html">8. Optimising workflow performance</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="awkward.html">9. Awkward corners</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        10. Tidying up
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#breaking-up-the-snakefile">Breaking up the Snakefile</a></li>
<li><a href="#a-default-target">A default target</a></li>
<li><a href="#using-snakemake-with-git">Using Snakemake with Git</a></li>
<li><a href="#readme"><code>README</code></a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="publishing.html">11. Publishing your workflow</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="awkward.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="publishing.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="awkward.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Awkward corners
        </a>
        <a class="chapter-link float-end" href="publishing.html" rel="next">
          Next: Publishing your...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Tidying up</h1>
        <p>Last updated on 2025-10-09 |

        <a href="https://github.com/edbennett/snakemake-novice-lattice/edit/main/episodes/cleanup.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do I split a Snakefile into manageable pieces?</li>
<li>How do I avoid needing to list every file to generate in my
<code>snakemake</code> call?</li>
<li>What should I bear in mind when using Git for my Snakemake
workflow?</li>
<li>What should I include in the README for my workflow?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Be able to avoid having long monolithic Snakefiles</li>
<li>Be able to have Snakemake generate a set of targets without
explicitly specifying them</li>
<li>Understand how to effectively use Git to version control Snakemake
worfklows</li>
<li>Be able to write an effective README on how to use a workflow</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="breaking-up-the-snakefile">Breaking up the Snakefile<a class="anchor" aria-label="anchor" href="#breaking-up-the-snakefile"></a></h2>
<hr class="half-width"><p>So far, we have written all of our rules into a single long file
called <code>Snakefile</code>. As we continue to add more rules, this
can start to get unwieldy, and we might want to break it up into smaller
pieces.</p>
<p>Let’s do this now. We can take the rules relating only to the
<code>pg</code> output files, and place them into a new file
<code>workflow/rules/pg.smk</code>. In their place, in the
<code>Snakefile</code>, we add the line</p>
<pre class="snakemake"><code><span><span class="va">include</span><span class="op">:</span> <span class="st">"rules/pg.smk"</span></span></code></pre>
<p>This tells Snakemake to take the contents of the new file we created,
and place it at that point in the file. Unlike Python, where the
<code>import</code> statement creates a new <em>scope</em>, in
Snakemake, anything defined above the <code>include</code> line is
available to the included code. So we are safe to use the configuration
parameters and metadata that we load at the top of the file.</p>
<div id="clean-out-the-snakefile" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="clean-out-the-snakefile" class="callout-inner">
<h3 class="callout-title">Clean out the <code>Snakefile</code>
</h3>
<div class="callout-content">
<p>Sort the remaining rules in the <code>Snakefile</code> into
additional <code>.smk</code> files. Place these in the
<code>rules</code> subdirectory with <code>pg.smk</code>.</p>
<p>One possible breakdown to use would be</p>
<ul><li>Rules relating to correlation function fits</li>
<li>Rules relating to the Wilson flow</li>
<li>Rules combining output of more than one ensemble</li>
</ul></div>
</div>
</div>
<div id="tidy-up-the-plot_styles" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="tidy-up-the-plot_styles" class="callout-inner">
<h3 class="callout-title">Tidy up the <code>plot_styles</code>
</h3>
<div class="callout-content">
<p>You might have noticed that we’re using the <code>plot_styles</code>
configuration option as an argument to the plotting rules, but without
including it in the <code>input</code> blocks. Since the argument is a
filename, it is a good idea to let Snakemake know about this, so that if
we adjust the style file, Snakemake knows to re-run the plotting
rules.</p>
<p>Make that change now for all rules depending on
<code>plot_styles</code>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="a-default-target">A default target<a class="anchor" aria-label="anchor" href="#a-default-target"></a></h2>
<hr class="half-width"><p>When we come to run the full workflow to generate all of the assets
for our publication, it is frustrating to need to list every single file
we would like. It is much better if we can do this as part of the
workflow, and ask Snakemake to generate a default set of targets.</p>
<p>We can do this by adding the following rule above all others in our
<code>Snakefile</code>:</p>
<pre class="snakemake"><code>tables = expand("assets/tables/{table}.tex", table=["counts"])
plots = expand(
    f"assets/plots/{{plot}}{config['plot_filetype']}",
    plot=["plaquette_scan", "spectrum"],
)


rule all:
    input:
        plots=plots,
        tables=tables,
    default_target: True</code></pre>
<p>Unlike the rules we looked at in the previous section, this one
should stay in the main Snakefile. Note that the rule only has
<em>inputs</em>: Snakemake sees that those files must be present for the
rule to complete, so runs the rules necessary to generate them. When we
call Snakemake with no targets, as</p>
<pre class="shellsession"><code>snakemake --cores all --use-conda</code></pre>
<p>then Snakemake will look to the <code>all</code> rule, and make
<code>assets/tables/counts.tex</code>,
<code>assets/plots/plaquette_scan.pdf</code>, and
<code>assets/plots/spectrum.pdf</code>, along with any intermediary
files they depend on.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>It can also be a good idea to add a provenance stamp at this point,
where you create an additional data file listing all outputs the
workflow generated, along with hashes of their contents, to make it more
obvious if any files left over from previous workflow runs sneak into
the output.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="using-snakemake-with-git">Using Snakemake with Git<a class="anchor" aria-label="anchor" href="#using-snakemake-with-git"></a></h2>
<hr class="half-width"><p>Using a version control system such as <a href="https://git-scm.org" class="external-link">Git</a> is good practice when developing
software of any kind, including analysis workflows. There are some steps
that we can take to make our workflows fit more nicely into Git.</p>
<p>Firstly, we’d like to avoid committing files to the repository that
aren’t part of the workflow definition. We make use of the file
<code>.gitignore</code> in the repository root for this. In general, our
Git repository should only contain things that should not change from
run to run, such as the workflow definition and any workflow-specific
code. Some examples of things that probably shouldn’t be committed
include:</p>
<ul><li>Input data and metadata. These should live and be shared separately
from the workflow, as they are inputs to the analysis rather than a
dedicated part of the analysis workflow. This means that someone wanting
to read the code doesn’t need to download gigabytes of unwanted
data.</li>
<li>Intermediary and output files. You may wish to share these with
readers, and the output plots and tables should be included in your
papers. But if a reader wants these from the workflow, they should
download the input data and workflow, and run the latter. Mixing
generated files with the repository will confuse matters, and make it so
that any workflow re-runs create unwanted “uncommitted changes” that Git
will notify you about.</li>
<li>
<code>.snakemake</code> directory. Similarly to the intermediary and
output files, this will change from machine to machine and should not be
committed. (In particular, it will get quite large with Conda
environments, which are only useful on the computer they were created
on.)</li>
</ul><div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If you quote data from another paper, and have had to transcribe this
into a machine-readable format like CSV yourself, then this may be
included in the repository, since it is not a data asset that you can
reasonably publish in a data repository under your own name. In this
case, the data’s provenance and attribution should be clearly
stated.</p>
</div>
</div>
</div>
<p>Let’s add these to the <code>.gitignore</code> for our workflow
now.</p>
<pre class="shellsession"><code>nano .gitignore</code></pre>
<p>To this file, we’ll add the lines</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>.snakemake/
raw_data/
metadata/
intermediary_data/
assets/
data_assets/</code></pre>
</div>
<p>Someone downloading your workflow will need to place the input data
and metadata in the correct locations. You might wish to prepare an
empty directory for the reader to place the necessary files into Since
Git does not track empty directories, only files, we create an empty
file in it, and update the <code>.gitignore</code> rules to un-ignore
only that file.</p>
<pre class="shellsession"><code>touch metadata/.git_keep
nano .gitignore</code></pre>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>!*/.git_keep</code></pre>
</div>
<p>Let’s commit these changes now</p>
<pre class="shellsession"><code>git add .gitignore
git commit -m "Ignore workflow inputs, and outputs, and temporary files"
git add metadata/.git_keep
git commit -m "Prepare empty directory for metadata"</code></pre>
<p>Where you use libraries that you have written, that are not on the <a href="https://pypi.org" class="external-link">Python Package Index</a>, it is a good idea to
incorporate these as Git submodules in your workflow. While
<code>pip</code> can install packages from GitHub repositories, this is
not robust against you moving or closing your GitHub account later, or
GitHub stopping offering free services. Instead, you can make available
a ZIP file containing the workflow and its primary dependencies, which
will continue to be installable significantly further into the
future.</p>
<p>Currently we have a directory <code>libs/su2pg_analysis</code>,
containing the library we have used for most of this analysis. This
library is hosted on GitHub at
<code>https://github.com/edbennett/su2pg_analysis</code>. To track this
as a Git submodule, we use the command</p>
<pre class="shellsession"><code>git submodule add https://github.com/edbennett/su2pg_analysis libs/su2pg_analysis
git commit -m "Add su2pg_analysis as submodule"</code></pre>
<div id="what-to-include" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="what-to-include" class="callout-inner">
<h3 class="callout-title">What to include?</h3>
<div class="callout-content">
<p>Which of the following files should be included in a hypothetical
workflow repository?</p>
<ol style="list-style-type: decimal"><li>
<code>sort.py</code>, a tool for putting results in the correct
order to show in a paper.</li>
<li>
<code>out_corr</code>, a correlation function output file.</li>
<li>
<code>Snakefile</code>, the workflow definition.</li>
<li>
<code>.snakemake/</code>, the Snakemake cache directory.</li>
<li>
<code>spectrum.pdf</code>, a plot created by the workflow.</li>
<li>
<code>prd.mplstyle</code>, a Matplotlib style file used by the
workflow.</li>
<li>
<code>README.md</code>, guidelines on how to use the workflow.</li>
<li>
<code>id_rsa</code>, the SSH private key used to connect to clusters
to run the workflow.`</li>
</ol></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>Yes, this tool is clearly part of the workflow, so should be
included in the repository, unless it’s being used from an external
library.</li>
<li>No, this is input data, so is not part of the software. This should
be part of a data release, as otherwise a reader won’t be able to run
the workflow, but should be separate to the Git repository.</li>
<li>Yes, our workflow release wouldn’t be complete without the workflow
definition.</li>
<li>No, this directory contains files that are specific to your
computer, so aren’t useful to anyone else.</li>
<li>No, this will change from run to run, and is not part of the
software. A reader can regenerate it from your code and data, by using
the workflow.</li>
<li>Yes, while this is input to the workflow, it does not change based
on the input data, and isn’t generated from the physics, so forms part
of the workflow itself.</li>
<li>Yes, this is essential for a reader to be able to understand how to
use the workflow, so should be part of the repository.</li>
<li>No, this is private information that may allow others to take over
or abuse your supercomputing accounts. Be very careful not to put
private information in public Git repositories!</li>
</ol></div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="readme"><code>README</code><a class="anchor" aria-label="anchor" href="#readme"></a></h2>
<hr class="half-width"><p>In general, we would like others to be able to reproduce our
work—this is a key aspect of the scientific method. To this end, it’s
important to let them know how to use our workflow, to minimise the
amount of effort that must be spent getting it running. By convention,
this is done in a file called <code>README</code>, (with an appropriate
file extension).</p>
<p>In this context, it’s good to remember that “other people” includes
“your collaborators” and “yourself in six months’ time”, so writing a
good README isn’t just good citizenship to help others, it’s also
directly beneficial to you and those you work with.</p>
<p>One good format to write a README in is <a href="https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax" class="external-link">Markdown</a>.
This is rendered to formatted text automatically by most Git hosting
services, including GitHub. When using this, the file is conventionally
called <code>README.md</code>.</p>
<p>Things you should include in your README include:</p>
<ul><li>A brief statement of what the workflow does, including a link to the
paper it was written for.</li>
<li>A listing of what software is required, including links for
installation instructions or downloads. (Snakemake is one such piece of
software.)</li>
<li>Instructions on downloading the repository and necessary data,
including a link to where the data can be found.</li>
<li>Instructions on how to run the workflow, including the suggested
<code>snakemake</code> invocation.</li>
<li>An indication of the time required to run the workflow, and the
hardware that that estimate applies to.</li>
<li>Details of where output from the workflow is placed.</li>
<li>An indication of how reusable the workflow is: is it intended to
work with any set of input data, and has it been tested for this, or is
it designed for the specific dataset being analysed?</li>
</ul><p>Rather than writing from fresh, you may wish to work from a template
for this. One suitable README template can be found in <a href="https://github.com/telos-collaboration/workflow_template/blob/main/README.md" class="external-link">the
TELOS Collaboration’s workflow template</a></p>
<div id="write-a-readme" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="write-a-readme" class="callout-inner">
<h3 class="callout-title">Write a README</h3>
<div class="callout-content">
<p>Use the <a href="https://github.com/telos-collaboration/workflow_template/blob/main/README.md" class="external-link">TELOS
Collaboration template</a> to draft a file <code>README.md</code> for
the workflow we have developed.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul><li>Use <code>.smk</code> files in <code>workflow/rules</code> to
compartmentalise the <code>Snakefile</code>, and use <code>input:</code>
lines in the main <code>Snakefile</code> to link them into the
workflow.</li>
<li>Add a rule at the top of the <code>Snakefile</code> with
<code>default_target: True</code> to specify the default output of a
workflow.</li>
<li>Use <code>.gitignore</code> to avoid committing input or output data
or the Snakemake cache.</li>
<li>Use <code>.git_keep</code> files to preserve empty directories.</li>
<li>Use Git submodules to link to libraries you have written that aren’t
on PyPI.</li>
<li>Include a <code>README.md</code> in your repository explaining how
to run the workflow.</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="awkward.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="publishing.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="awkward.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Awkward corners
        </a>
        <a class="chapter-link float-end" href="publishing.html" rel="next">
          Next: Publishing your...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/edbennett/snakemake-novice-lattice/edit/main/episodes/cleanup.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/edbennett/snakemake-novice-lattice/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/edbennett/snakemake-novice-lattice/" class="external-link">Source</a></p>
				<p><a href="https://github.com/edbennett/snakemake-novice-lattice/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:e.j.bennett@swansea.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.7" class="external-link">varnish (1.0.7)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://edbennett.github.io/snakemake-novice-lattice/cleanup.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries, snakemake, lattice quantum field theory",
  "name": "Tidying up",
  "creativeWorkStatus": "active",
  "url": "https://edbennett.github.io/snakemake-novice-lattice/cleanup.html",
  "identifier": "https://edbennett.github.io/snakemake-novice-lattice/cleanup.html",
  "dateCreated": "2025-01-03",
  "dateModified": "2025-10-09",
  "datePublished": "2025-10-09"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

